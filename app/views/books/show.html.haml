- content_for :javascripts do
  = javascript_include_tag 'reviews/raty', 'data-turbolinks-track': 'reload'

= link_to request.referer.present? ? request.referer : books_path,
          class: 'general-back-link' do
  %i.fa.fa-long-arrow-left.mr-15
  = t '.back_to_results'
.row
  .col-sm-6
    .product-gallery
      .mb-20
        = image_tag @book.image_url, class: 'img-responsive'
      .images.clearfix
        = link_to @book.image_url, class: 'img-link' do
          = image_tag @book.image_url
        -#   %img{src: "https://www.smashingmagazine.com/wp-content/uploads/2015/09/smashing-book-5-2-large.jpg"}
        = link_to @book.image_url, class: 'img-link' do
          = image_tag @book.image_url
        = link_to @book.image_url, class: 'img-link' do
          = image_tag @book.image_url
  .col-sm-6
    %h1.mt-res-0
      = @book.title
    %p.lead.small
      = book.authors_names
    .row
      .col-xs-12.col-md-4
        %p.h1.in-gold-500.mt-10
          = number_to_currency(@book.price)
      .col-xs-5.col-md-3
        .input-group.general-position
          = form_tag line_items_path(book_id: @book.id), id: 'line-item-form' do
            = link_to '', class: 'input-link',
                      onclick: "decrementQuantity(); return false;" do
              %i.fa.fa-minus.line-height-40
            -# %a.input-link{href: "#"}
            -#   %i.fa.fa-minus.line-height-40
            %input.form-control.quantity-input{name: 'quantity', type: "text", value: 1}
            -# = text_field_tag :quantity, class: 'form-control quantity-input', value: 1
            -# = submit_tag t('.add_to_cart'), class: 'btn btn-default pull-right general-position'
            = link_to '', class: 'input-link',
                      onclick: "incrementQuantity(); return false;" do
              %i.fa.fa-plus.line-height-40
            -# %a.input-link{href: "#"}
            -#   %i.fa.fa-plus.line-height-40
      .col-xs-7.col-md-5
        -# = button_to t('.add_to_cart'),
        -#             line_items_path(book_id: @book, quantity: quantity),
        -#             class: 'btn btn-default pull-right general-position'
        %button.btn.btn-default.pull-right.general-position{type: 'submit', form: 'line-item-form'}
          = t '.add_to_cart'
    .general-info-wrap.divider-lg
      %p= t '.description'
      %p.lead.small.line-height-2
        = book.short_description
        - if @book.description.length > 500
          = link_to t('.read_more'), '', id: "read-more-#{@book.id}",
                    class: 'in-gold-500 ml-10',
                    onclick: "readMore('#{book.full_description}'); return false;"
    .general-info-wrap.divider-lg
      .clearfix
        %p.pull-left= t '.publication_year'
        %p.lead.small.pull-right= @book.publication_year
    .general-info-wrap.divider-lg
      .clearfix
        %p.pull-left= t '.dimensions'
        %p.lead.small.pull-right= @book.dimensions
    .general-info-wrap.divider-lg
      .clearfix
        %p.pull-left= t '.materials'
        %p.lead.small.pull-right= @book.materials
.mb-80
  %h3.in-gold-500.mb-25= "#{t '.reviews'} (#{@book.reviews.count})"
  - if @book.reviews.approved.any?
    = render @book.reviews.approved.order('created_at DESC')

    - if user_signed_in?
      = t '.write_a_review'
      = form_for [@book, @book.reviews.build] do |f|
        - if flash[:errors]
          #error_explanation
            %h2= "#{pluralize(flash[:errors].count, "error")} prohibited this review from being saved:"
            %ul
              - flash[:errors].each do |error|
                %li= error.join ' '
        .field
          = f.label :score
          #star-rating
          -# = f.number_field :score, id: "star-rating"
        .field
          = f.label t('.review_title')
          = f.text_field :title
        .field
          = f.label t('.review_text')
          = f.text_area :text
        .actions
          = f.submit t('.post_review')

-# %p#notice= notice
-#
-# %p
-#   %b Title:
-#   = @book.title
-# %p
-#   %b Description:
-#   = @book.description
-# %p
-#   %b Price:
-#   = @book.price
-# %p
-#   %b Image url:
-#   = @book.image_url
-# %p
-#   %b Publication year:
-#   = @book.publication_year
-# %p
-#   %b Dimensions:
-#   = @book.dimensions
-# %p
-#   %b Materials:
-#   = @book.materials
-#
-# = link_to 'Edit', edit_book_path(@book)
-# \|
-# = link_to 'Back', books_path
